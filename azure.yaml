# yaml-languageserver: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: azd-test

infra:
  path: infra
  provider: bicep
  module: main

hooks:
  preup:
    shell: sh
    run: ./src/scripts/preup.sh

  preprovision:
    shell: sh
    run: ./src/scripts/preprovision.sh
  postprovision:
    shell: sh
    run: ./src/scripts/postprovision.sh

  prepackage:
    shell: sh
    run: ./src/scripts/prepackage.sh
  postpackage:
    shell: sh
    run: ./src/scripts/postpackage.sh

  predeploy:
    shell: sh
    run: ./src/scripts/predeploy.sh
  postdeploy:
    shell: sh
    run: ./src/scripts/postdeploy.sh

  postup:
    shell: sh
    run: ./src/scripts/postup.sh

services:
  python-client:
    project: ./src/apps/client
    host: containerapp
    language: docker
    docker:
      path: ./Dockerfile
      context: .
      registry: ${AZURE_CONTAINER_REGISTRY_ENDPOINT}
